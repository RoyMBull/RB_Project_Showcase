/** Wireless Transmitter/Reciever Module 
 * DOWNLOAD THE nRF24LO1 MODULE FROM HERE: https://github.com/maniacbug/RF24
 * Extract it to the libraries folder of the arduino IDE, located in Documents > Arduino > libraries 
 * VIDEO EXAMPLE: https://www.youtube.com/watch?v=1ibAiPNeQSI 

    Board Setup: (SEE THE IMAGE ATTATCHED)
        # Connect the first pin to ground
        # Connect the second pin to the 3.3v pin of the arduino (DO NOT USE 5V OR IT WILL DESTROY THE MODULE)
        # Connect the 3rd pin to digital pin 7 of the arduino (can be others if desired)
        # Connect the 4th pin to the digital 8 pin of the arduino (can also be others if desired)
        # Connect the 5th pin to the digital 13 pin of the arduino 
        # Connect the 6th pin to the digital 11 pin of the arduino 
        # Connect the 7th pin to the digital 12 pin of the arduino
        # Connect the 8th pin to the 

        radio.stopListening() // This sets the wireless tranciever module as transmitter
        radio.startListening() // This sets the wireless tranciever module as reciever

**/

#include <SPI.h>
#include <nRF24L01.h>
#include <RF24.h>

RF24 radio(7, 8); //Radio object

const byte DataChannel[][6] = {"00001", "00002"}; //address of the communication channel of the transmitter

//Commands
//FORWARD, BACKWARD, LEFT, RIGHT
const char Forward[] = "8";
const char Backward[] = "2";
const char Left[] = "4";
const char Right[] = "6";

//Analog Objects
int pin2 = 2;
int analog0 = 0;
int analog1 = 1;
int pin13 = 13;
int LeftAnalogXaxisData;
int LeftAnalogYaxisData;

//Responses
char ResponseData[35] = "";

int UserInput;

void setup()
{   
    Serial.begin(9600);
    pinMode(pin2, INPUT);
    pinMode(pin13, OUTPUT);
    radio.begin(); //Begins radio communicationn
    radio.openWritingPipe(DataChannel[1]); // Writes data to a defined address
    radio.openReadingPipe(1, DataChannel[0]); // Recieves response data 
    radio.setPALevel(RF24_PA_MIN); //Power Amplifier level
}

void loop()
{
    //Reads analog input from the Analog Sticks
    LeftAnalogXaxisData = analogRead(analog0);
    delay(10);
    LeftAnalogYaxisData = analogRead(analog1);
    delay(10);

  //PINS FACING RIGHT (Left Analog Stick WITH BLACK GROUND PIN WIRE)
   //DRONE MOVEMENT: FORWARD, BACKWARD, LEFT, RIGHT 
   //Move Backward
   if (LeftAnalogYaxisData <= 520)
   {
       Serial.println("Sending data....");
       radio.stopListening();
       bool RadioData = radio.write(&Backward, sizeof(Backward));
       delay(10);

       if (RadioData == true)
       {
          Serial.println("Data Sent!");
          radio.startListening();
          
          if (radio.available())
          {
            radio.read(&ResponseData, sizeof(ResponseData));   
            Serial.println(ResponseData);                    
          }
       }      
   }
   
  //Move Forward
   else if (LeftAnalogYaxisData >= 535)
   {
      Serial.println("Sending data....");
       radio.stopListening();
       bool RadioData = radio.write(&Forward, sizeof(Forward));
       delay(10);

       if (RadioData == true)
       {
          Serial.println("Data Sent!");
          radio.startListening();
          
          if (radio.available())
          {
            radio.read(&ResponseData, sizeof(ResponseData));   
            Serial.println(ResponseData);                    
          }
       }      
   }

   //Move Right
   else if (LeftAnalogXaxisData <= 510)
   {
      Serial.println("Sending data....");
       radio.stopListening();
       bool RadioData = radio.write(&Right, sizeof(Right));
       delay(10);

       if (RadioData == true)
       {
          Serial.println("Data Sent!");
          radio.startListening();
          
          if (radio.available())
          {
            radio.read(&ResponseData, sizeof(ResponseData));   
            Serial.println(ResponseData);                    
          }
       }      
   }

   //Move Left
   else if (LeftAnalogXaxisData >= 520)
   {
      Serial.println("Sending data....");
       radio.stopListening();
       bool RadioData = radio.write(&Left, sizeof(Left));
       delay(10);

       if (RadioData == true)
       {
          Serial.println("Data Sent!");
          radio.startListening();
          
          if (radio.available())
          {
            radio.read(&ResponseData, sizeof(ResponseData));   
            Serial.println(ResponseData);                    
          }
       }      
   }

}